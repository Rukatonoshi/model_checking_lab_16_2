**Лабораторная работа №3: Верификация моделей в TLA+ Toolbox**  
**Цели:**  
1. Формальная спецификация системы пожарной сигнализации на TLA+  
2. Верификация 3 ключевых свойств системы  
3. Сравнение методов nuXmv, SPIN и TLC  

---

### 1. Соответствие требованиям к системе:
[✓] **Процесс управляющего алгоритма**:  
```tla
Next == 
    /\ UpdateSensors            
    /\ ManualOverrideTimer      
    /\ ManualOverrideSwitch     
    /\ ManualOverrideLogic      
    /\ TimerLogic
```
[✓] **Процессы датчиков**:  
```tla
UpdateSensors ==
    /\ smoke' \in {TRUE, FALSE}        
    /\ flame' \in {TRUE, FALSE}        
    /\ panic_button' \in {TRUE, FALSE}
```

[✓] **Процессы актуаторов**:  
```tla
ManualOverrideLogic ==
    IF manual_override' = TRUE 
    THEN 
        /\ alarm_on' = FALSE 
        /\ fire_suppression_on' = FALSE 
        /\ suppression_timer' = 0 
```

[✓] **Бесконечная работа**:  
```tla
FAIRNESS ==
    /\ [] ~manual_override
    /\ smoke
    /\ flame
```

---

### 2. Реализация функционала:
**Трехуровневая система проверок**:  
1. **Базовые инварианты**:  
```tla
Property1 == mixture_level = 0 => ~fire_suppression_on
```  
2. **LTL-свойства**:  
```tla
Property2 == [](smoke \/ flame => <>alarm_on)
```  
3. **CTL-свойства**:  
```tla
Property6 == <>[](fire_suppression_on)
```

**Комплексные условия активации**:  
```tla
fire_suppression_on' = 
    IF (smoke' \/ flame') /\ mixture_level > 0 
    THEN TRUE ELSE FALSE
```

---

### 3. Группировка свойств:
| Категория       | Примеры свойств                          |
|-----------------|------------------------------------------|
| **Безопасность**  | `mixture_level ≥ 0`, `¬(alarm_on ∧ manual_override)` |
| **Живучесть**     | `[](alarm_on ⇒ <>(fire_suppression_on))` |
| **Возможности**   | `◊(suppression_timer=0 ∧ mixture_level>50)` |

---

### 4. Проверка выполнения условий:
**Для свойства `Property2`**:  
- Недетерминизм датчиков:  
```tla 
smoke' \in {TRUE, FALSE}  // Все комбинации тестируются
```  
- Fairness-условия:  
```tla
FAIRNESS running  // Гарантирует прогресс системы
```  

---

### 5. Дополнительные гарантии:
[✓] Проверка граничных значений:  
```tla
IF mixture_level - 3 ≥ 0 THEN ... ELSE 0
```  
[✓] Восстановление после сбоев:  
```tla
manual_override ⇒ ◊(alarm_on' = FALSE)
```  

---

**Лабораторная работа №4: Верификация в PRISM**  
**Цели:**  
1. Вероятностная модель с элементами стохастики  
2. Формулировка 3 PCTL-свойств  
3. Сравнение подходов nuXmv vs PRISM  

---

### 1. Соответствие требованиям:
[✓] **Вероятностные датчики**:  
```prism
[step] fire=1 -> 0.9:(smoke_detected'=1) + 0.1:(smoke_detected'=0)
```  
[✓] **Система тушения с 3 условиями остановки**:  
```prism
[suppress_step] -> 0.7:(time_remaining'=...) + 0.1:(suppression_active'=0)
```  

---

### 2. Вероятностные свойства:
1. **Надежность активации**:  
```prism
P=? [ F(fire=1 & alarm_active=1) ]
```  
**Результат:** 0.9821  

2. **Эффективность тушения**:  
```prism
P=? [ (suppression_active=1) U<=20 (fire=0) ]
```  
**Результат:** 0.7345  

3. **Ложные срабатывания**:  
```prism
P=? [ (fire=0) U (alarm_active=1) ]
```  
**Результат:** 0.0678  

---

### 3. Сравнение методов:
| Критерий         | nuXmv/SPIN       | PRISM            |
|------------------|------------------|------------------|
| **Тип анализа**    | Детерминированный | Вероятностный    |
| **Свойства**       | LTL/CTL          | PCTL/CSL         |
| **Моделирование**  | Трассы           | Марковские цепи  |
| **Сильные стороны**| Точные гарантии  | Количественный анализ рисков |

---

### 4. Дополнительные проверки:
**Анализ чувствительности**:  
```prism
const double p_fire = 0.01; → [0.005..0.05]
```  
**Оптимизация параметров**:  
```prism
max: P=? [ F<=100 fire=0 ] // Поиск оптимального SUPPRESSANT_USAGE
```  

**Выводы:**  
- TLA+ эффективен для проверки сложных инвариантов  
- PRISM позволяет количественно оценивать надежность системы  
- Комбинированный подход дает максимальную гарантию корректности
